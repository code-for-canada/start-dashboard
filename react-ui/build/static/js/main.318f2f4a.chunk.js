(this["webpackJsonpstart-dashboard"]=this["webpackJsonpstart-dashboard"]||[]).push([[0],{396:function(e,t,a){e.exports=a.p+"static/media/blob1.3ba66310.svg"},397:function(e,t,a){e.exports=a.p+"static/media/blob2.a8532d52.svg"},418:function(e,t,a){e.exports=a(895)},894:function(e,t,a){},895:function(e,t,a){"use strict";a.r(t);a(419),a(428);var n=a(0),r=a.n(n),l=a(11),o=a.n(l),c=a(24),s=a(22),i=function(){return r.a.createElement("footer",{className:"bg-white p-3 text-center shadow-depth"},r.a.createElement("p",{className:"m-0"},"\xa9 Street Art Toronto 2020"))},m=function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("img",{src:"https://cdn.auth0.com/blog/auth0-react-sample/assets/loading.svg",alt:"Loading"}))},u=a(25),d=a(929),p=a(930),b=a(919),f=a(922),h=a(918),E=function(){var e=Object(s.b)().logout;return r.a.createElement(h.a,{onClick:function(){return e({returnTo:window.location.origin})},variant:"danger",className:"btn-margin"},"Log Out")},g=function(){var e=Object(s.b)().loginWithRedirect;return r.a.createElement(h.a,{onClick:function(){return e()},variant:"primary",className:"btn-margin"},"Log In")},v=function(){return r.a.createElement(d.a,{className:"ml-auto"},r.a.createElement(d.a.Link,{as:u.c,to:"/",exact:!0,className:"text-dark",activeClassName:"router-link-exact-active"},"Dashboard"),r.a.createElement(d.a.Link,{as:u.c,to:"/map",exact:!0,className:"text-dark",activeClassName:"router-link-exact-active"},"Map"),r.a.createElement(d.a.Link,{as:u.c,to:"/location",exact:!0,className:"text-dark",activeClassName:"router-link-exact-active"},"Add location"))},y=function(){return r.a.createElement(d.a,{className:"ml-auto"},r.a.createElement(d.a.Link,{href:"https://streetartoronto.ca/",className:"text-dark"},"StART Map"))},w=function(e){var t=e.isAuthenticated,a=void 0===t||t;return r.a.createElement(d.a,{className:"justify-content-end ml-md-4"},a?r.a.createElement(E,null):r.a.createElement(g,null))},k=function(){var e=Object(s.b)(),t=e.isAuthenticated,a=e.user,n=a["https://streetartoronto.ca/name"]||a.nickname,l=a["https://streetartoronto.ca/role"]||"Artist";return r.a.createElement(p.a,{bg:"white",expand:"md",collapseOnSelect:!0,className:"shadow-depth px-0"},r.a.createElement(b.a,{maxWidth:"xl"},r.a.createElement(f.a,{container:!0,justify:"space-between"},r.a.createElement(f.a,{item:!0},r.a.createElement(d.a.Link,{as:u.c,to:"/",exact:!0,className:"text-dark text-bold pl-0",activeClassName:"router-link-exact-active"},n?"Hi, ".concat(n,"! \ud83d\udc4b"):"StART Guest")),r.a.createElement(f.a,{item:!0},r.a.createElement(p.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(p.a.Collapse,{id:"responsive-navbar-nav"},function(e){switch(e){case"StART Staff":return r.a.createElement(v,null);case"Artist":return r.a.createElement(y,null);default:return null}}(l),r.a.createElement(w,{isAuthenticated:t}))))))},N=a(413),S=function(e){var t=e.component,a=Object(N.a)(e,["component"]);return r.a.createElement(c.b,Object.assign({component:Object(s.c)(t,{onRedirecting:function(){return r.a.createElement(m,null)}})},a))},j=a(16),O=a(923),x=a(396),C=a.n(x),A=a(397),P=a.n(A),T=function(){var e=Object(n.useState)(),t=Object(j.a)(e,2),a=t[0],l=t[1];Object(n.useEffect)((function(){a||fetch("https://raw.githubusercontent.com/code-for-canada/start-map/master/public/geojson/ftrs.json").then((function(e){return e.json()})).then((function(e){var t=e.features[Math.floor(Math.random()*e.features.length)];console.log(t),t.properties.media&&t.properties.media.length>0?l(t.properties.media[0].url):l("https://dl.airtable.com/.attachments/bf85b19d45989b61b38d0499a0c9ab3d/bcb3bc8b/UNADJUSTEDRAW_thumb_f416.jpg")}))}));var o={contentArea:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},backgroundImage:{backgroundImage:"url(".concat(a,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},content:{height:"100%",width:"100%",position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},contentBackground:{position:"relative",height:"100%",width:"100%"}};return r.a.createElement("div",{className:"bg-img h-100 w-100",style:o.backgroundImage,"data-aos":"fade-in"},r.a.createElement(O.a,{className:"flex-grow-1"},r.a.createElement("div",{className:"content-area col-8 col-md-6 pt-5",style:o.contentArea},r.a.createElement("div",{className:"background",style:o.contentBackground},r.a.createElement("img",{src:C.a,alt:"",className:"rotateme",style:{position:"absolute",opacity:"0.9"}}),r.a.createElement("img",{src:P.a,alt:"",className:"rotateme-reverse",style:{opacity:"0.9"}})),r.a.createElement("div",{className:"content p-5",style:o.content},r.a.createElement("h1",{className:"mb-5"},"StART Digital"),r.a.createElement(g,null)))))},L=function(e){var t=e.children;return r.a.createElement("div",{id:"app",className:"d-flex flex-column h-100"},r.a.createElement(k,null),r.a.createElement("main",null,t),r.a.createElement(i,null))},I=function(){return r.a.createElement(L,null,r.a.createElement("iframe",{title:"Artwork status update form",className:"airtable-embed",src:"https://airtable.com/embed/shrvLFrcxroCiCWgr?backgroundColor=red",frameBorder:"0",width:"100%",height:"1125",style:{background:"transparent",border:"1px solid #ccc"}}))},_=a(925),D=a(926),R=a(64),F=function(e){var t=e.title,a=e.src,l=e.width,o=e.height,c=e.style,s=e.className,i=Object(n.useState)(!1),m=Object(j.a)(i,2),u=m[0],d=m[1],p={pointerEvents:u?"auto":"none"};return r.a.createElement("div",{onClick:function(){d(!0)},onMouseLeave:function(){d(!1)},className:"iframe-container"},r.a.createElement("iframe",{title:t,className:"".concat(s," airtable-embed"),src:a,frameBorder:"0",width:l,height:o,style:Object(R.a)(Object(R.a)({},p),c)}))};F.defaultProps={width:"100%",height:"533",style:{background:"transparent",border:"1px solid #ccc"},className:""};var M=F,z=a(255),J=a.n(z),W=a(254),V=a.n(W),q=a(398),U=a.n(q),G=function(e){var t=e.title,a=e.editLink,n=e.editText,l=e.isVisible,o=e.isSmall,c=e.index,s=e.children,i=e.toggleVisibility,m=e.toggleSize;return r.a.createElement("div",{className:"panel my-3 ".concat(l?"open":"closed"," ").concat(o?"col-lg-6":"col-lg-12")},r.a.createElement("div",{className:"header d-flex justify-content-between p-1 align-items-center"},r.a.createElement("div",{className:"d-flex"},r.a.createElement("h2",{className:"mb-0 mx-3"},t),r.a.createElement("a",{className:"d-none d-md-block",href:a,target:"_blank",rel:"noopener noreferrer"},n)),r.a.createElement("div",{className:"d-flex"},r.a.createElement("a",{className:"d-block d-md-none btn",href:a,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(U.a,null)),r.a.createElement("button",{className:"d-none d-lg-block btn",onClick:function(){return m(c)}},o?r.a.createElement(V.a,{style:{transform:"rotate(90deg)"}}):r.a.createElement(J.a,{style:{transform:"rotate(90deg)"}})),r.a.createElement("button",{className:"btn",onClick:function(){return i(c)}},l?r.a.createElement(J.a,null):r.a.createElement(V.a,null)))),r.a.createElement("div",{className:"body"},s))};G.defaultProps={isVisible:!0,isSmall:!1,editText:"Edit in Airtable",editLink:"https://airtable.com/tbl5ApSEOzPpe4fwp/viw2swQLeJ9xwU82F?blocks=hide"};var Y=G,B=a(927),Q=a(401),H=a.n(Q),Z=a(402),K=a.n(Z),X=a(399),$=a.n(X),ee=a(400),te=a.n(ee),ae=a(404),ne=a.n(ae),re=a(403),le=a.n(re),oe=a(149),ce=function(e){var t=function(e,t){var a=Object(n.useState)((function(){var a=window.localStorage.getItem(t);return null!==a?JSON.parse(a):e})),r=Object(j.a)(a,2),l=r[0],o=r[1];return Object(n.useEffect)((function(){window.localStorage.setItem(t,JSON.stringify(l))}),[t,l]),[l,o]}(e,"panels-config"),a=Object(j.a)(t,2),r=a[0],l=a[1];return{panels:r,toggleVisibility:function(e){var t=Object(oe.a)(r);t[e].isVisible=!r[e].isVisible,l(t)},toggleSize:function(e){var t=Object(oe.a)(r);t[e].isSmall=!r[e].isSmall,l(t)},moveUp:function(e){var t=Object(oe.a)(r);t[e]=r[e-1],t[e-1]=r[e],l(t)},moveDown:function(e){var t=Object(oe.a)(r);t[e]=r[e+1],t[e+1]=r[e],l(t)}}},se={lat:43.65347810000001,lng:-79.3841277},ie=[{id:"project-updates",title:"Project Updates",isVisible:!0,isSmall:!0,editLink:"https://airtable.com/tblhqR67jrTJ169Cf/viwvQN6OyFyxsPYtq?blocks=hide",editText:"Edit in Airtable",frameSrc:"https://airtable.com/embed/shrxrrqGr1tu5UKt9?backgroundColor=red&viewControls=on"},{id:"submit-updates",title:"Submit Update",isVisible:!0,isSmall:!0,editLink:"https://airtable.com/tblhqR67jrTJ169Cf/viwV5AQuGxE4OfNX0?blocks=hide",editText:"Edit in Airtable",frameSrc:"https://airtable.com/embed/shr087J79r2jG6rE2?backgroundColor=red"},{id:"artwork-status-board",title:"Artwork Status Board",isVisible:!1,isSmall:!1,editLink:"https://airtable.com/tbl5ApSEOzPpe4fwp/viwiX18oxXONzk8th?blocks=hide",editText:"Edit in Airtable",frameSrc:"https://airtable.com/embed/shrTlL5928ssPbMeP?backgroundColor=red&viewControls=on"},{id:"submissions",title:"Submissions",isVisible:!0,isSmall:!1,editLink:"https://streetartto.submittable.com/submissions",editText:"Edit in Submittable",frameSrc:"https://airtable.com/embed/shrqukWs4K0JgixB9?backgroundColor=red&viewControls=on"},{id:"artworks",title:"Artworks",isVisible:!0,isSmall:!1,editLink:"https://airtable.com/tbl5ApSEOzPpe4fwp/viwfmyIqZl3bsj2eo?blocks=hide",editText:"Edit in Airtable",frameSrc:"https://airtable.com/embed/shrdDGqIxvtiIjFzZ?backgroundColor=red&viewControls=on"},{id:"artists",title:"Artists",isVisible:!1,isSmall:!1,editLink:"https://www.cognitoforms.com/forms/startartistprofile/entries",editText:"Edit in CognitoForms",frameSrc:"https://airtable.com/embed/shra4E5FrOJS6fzWO?backgroundColor=red&viewControls=on"}],me="11",ue="https://airtable.com/tbleiRmVudM7u9BDE/viwEgRCnV41UaOmIk/",de=function(e){var t=e.onClick,a=e.disabled,n=e.children;return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{type:"text/css"},"\n        #panel-control-block svg {\n          width: 0.8em;\n        }\n        "),r.a.createElement("button",{onClick:t,disabled:a,className:"btn btn-secondary btn-light",type:"button"},n))},pe=function(e){var t=e.isVisible;return r.a.createElement(de,e,t?r.a.createElement($.a,null):r.a.createElement(te.a,null))},be=function(e){return r.a.createElement(de,e,r.a.createElement(H.a,null))},fe=function(e){return r.a.createElement(de,e,r.a.createElement(K.a,null))},he=function(e){var t=e.title,a=e.index,n=e.isVisible,l=e.isFirstItem,o=e.isLastItem,c=e.toggleVisibility,s=e.moveUp,i=e.moveDown;return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{type:"text/css"},"\n        .btn-group-micro > .btn {\n          padding: 0.1rem 0.25rem;\n        }\n        "),r.a.createElement("tr",null,r.a.createElement("td",{className:"align-middle"},r.a.createElement("nobr",null,t)),r.a.createElement("td",null,r.a.createElement("div",{className:"btn-group btn-group-micro",role:"group","aria-label":"Actions on view: ".concat(t)},r.a.createElement(pe,{isVisible:n,onClick:function(){return c(a)}}),r.a.createElement(be,{disabled:l,onClick:function(){return s(a)}}),r.a.createElement(fe,{disabled:o,onClick:function(){return i(a)}})))))},Ee=function(e){var t=e.panels;return r.a.createElement("div",{id:"panel-control-block"},r.a.createElement("h4",{className:"my-3"},"All views"),r.a.createElement("table",{className:"table table-sm small"},r.a.createElement("tbody",null,t.map((function(a,n){return r.a.createElement(he,Object.assign({},e,a,{index:n,key:a.id,isFirstItem:0===n,isLastItem:n===t.length-1}))})))))},ge=function(e){var t=Object(n.useState)(!1),a=Object(j.a)(t,2),l=a[0],o=a[1],c=e.children,s=function(e){return function(t){("keydown"!==t.type||"Tab"!==t.key&&"Shift"!==t.key)&&o(e)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-light btn-block",onClick:s(!0)},r.a.createElement(le.a,null)),r.a.createElement(B.a,{anchor:"right",open:l},r.a.createElement("div",{className:"mx-3 pt-2"},r.a.createElement("button",{className:"btn btn-light",type:"button",onClick:s(!1)},r.a.createElement(ne.a,null)),c)))},ve=function(){var e=ce(ie),t=e.panels,a=e.toggleVisibility,n=e.toggleSize,l=e.moveUp,o=e.moveDown;return r.a.createElement(O.a,{fluid:!0},r.a.createElement(_.a,{className:"mt-4"},r.a.createElement(D.a,null,r.a.createElement("h1",{className:"mb-2"},"StART Staff Dashboard")),r.a.createElement(D.a,{xs:1},r.a.createElement(ge,null,r.a.createElement(Ee,{panels:t,moveUp:l,moveDown:o,toggleVisibility:a})))),r.a.createElement(_.a,null,r.a.createElement(O.a,{fluid:!0},r.a.createElement(_.a,null,r.a.createElement(D.a,null,r.a.createElement(O.a,{fluid:!0,className:"px-0"},r.a.createElement(_.a,null,t.map((function(e,t){return r.a.createElement(Y,Object.assign({},e,{key:e.id,index:t,toggleVisibility:a,toggleSize:n}),r.a.createElement(M,{title:e.id,src:e.frameSrc}))})))))))))},ye=function(e){return r.a.createElement(O.a,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 mt-4"},r.a.createElement("h1",{className:"mb-4"},"Advisory Committee Dashboard Demo")),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"mb-4"},r.a.createElement("h2",{className:"mb-3"},"Submission Status Board"),r.a.createElement(M,{title:"Submission Status Board",src:"https://airtable.com/embed/shrqukWs4K0JgixB9?backgroundColor=red&viewControls=on"}))),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"mb-4"},r.a.createElement("h2",{className:"mb-3"},"New Submissions"),r.a.createElement(M,{title:"New Submissions",src:"https://airtable.com/embed/shrbgSefEwH2I8pgM?backgroundColor=red&viewControls=on"})))))},we=function(e){return r.a.createElement(O.a,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 mt-4"},r.a.createElement("h1",{className:"mb-4"},"Curator Dashboard Demo")),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"mb-4"},r.a.createElement("h2",{className:"mb-3"},"Published Artworks"),r.a.createElement(M,{title:"Published Artworks",src:"https://airtable.com/embed/shrTY5JWaHMkwbm80?backgroundColor=red&viewControls=onn"}))),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"mb-4"},r.a.createElement("h2",{className:"mb-3"},"Artists"),r.a.createElement(M,{title:"Artists",src:"https://airtable.com/embed/shrJegAZi7w7Kj5ue?backgroundColor=red&viewControls=on"})))))},ke=a(44),Ne=a.n(ke),Se=a(92),je=function(e){var t=e.children;return r.a.createElement("div",{className:"panel outlined bg-white p-4"},t)},Oe=function(e){var t=e.title;return r.a.createElement("h2",{className:"mb-4"},t)},xe=function(e){var t=e.formId,a=e.showForm,l=e.opts,o=e.afterSubmit,c=Object(n.useState)(!1),s=Object(j.a)(c,2),i=s[0],m=s[1],u=Object(n.useState)(null),d=Object(j.a)(u,2),p=d[0],b=d[1];if(Object(n.useEffect)((function(){if(!i&&a)try{window.Cognito.load("forms",Object(R.a)({id:t},l),{success:function(){window.ExoJQuery((function(){window.ExoJQuery(document).on("afterSubmit.cognito",o)}))}}),m(!0)}catch(e){console.log(e),b("This form is not available.")}}),[a,i,t,l,o]),p||!a){var f=p||"This form is not available";return r.a.createElement("p",null,f)}return r.a.createElement("div",{className:"cognito mt-4 mb-1"})};xe.defaultProps={showForm:!0,opts:{}};var Ce=xe,Ae=function(e){var t=e.url,a=Object(n.useState)(!1),l=Object(j.a)(a,2),o=l[0],c=l[1],s=function(){var e=Object(Se.a)(Ne.a.mark((function e(){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t);case 2:c(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"profile-url"},r.a.createElement("div",{className:"bg-light url p-2"},r.a.createElement("code",{id:"copy-url",className:"text-dark mr-2"},t),r.a.createElement("button",{className:"btn btn-secondary btn-sm",onClick:s},"".concat(o?"Copied!":"Copy"))))},Pe=function(e){var t=e.artist;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Welcome to StART Digital!"),r.a.createElement("p",null,"Please make sure to keep your profile up to date. This is how we contact you about your current projects, ongoing applications, or future opportunities we think you would be interested in."),r.a.createElement("p",null,"If you're applying for one of our programs, we may ask you for the link to your Artist Profile. You can copy it here."),r.a.createElement(Ae,{url:t.view_url})):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Welcome to StART Digital!"),r.a.createElement("p",null,"This is the online home of Street Art Toronto."),r.a.createElement("p",null,"Now that you've registered, you have access to the Artist Dashboard. You can create your Artist Profile and apply to current opportunities. If you are joining in a different capacity, you will need someone from the StART team to give you the appropriate permissions on this platform."))},Te=function(e){var t=e.artist,a=Object(c.h)().hash,n=t,l=null===t||void 0===t?void 0:t.view_url.includes(a);return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,{formId:me,showForm:l}),r.a.createElement(u.b,{className:"btn btn-primary mt-2",to:"/profile/edit"},"Edit your profile")):r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,{title:"StART Artist Profile"}),r.a.createElement("p",null,"Create an artist profile to join the StART artist community."),r.a.createElement("p",null,"What is this profile for?"),r.a.createElement("ul",{className:"ml-4"},r.a.createElement("li",null,"We review your artist profile when you apply to participate in our programs"),r.a.createElement("li",null,"For artworks you produce with StART, your profile lets you control the information that shows up on our public map"),r.a.createElement("li",null,"We may contact you about upcoming opportunities that fit your profile.")),r.a.createElement(u.b,{to:"/profile/edit",className:"btn btn-primary"},"Create your profile"))},Le=function(){var e=Object(n.useState)([]),t=Object(j.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){var e=new AbortController;return function(){var t=Object(Se.a)(Ne.a.mark((function t(){var a,n,r,o;return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/forms",{signal:e.signal});case 3:return n=t.sent,t.next=6,n.json();case 6:if(!(r=t.sent).error){t.next=9;break}return t.abrupt("return",console.log(r.error));case 9:(null===(o=null===r||void 0===r||null===(a=r.items)||void 0===a?void 0:a.filter((function(e){var t=new Date,a=!e.start_date||new Date(e.start_date)<=t,n=!!e.expire_date&&new Date(e.expire_date)<t;return e.active&&a&&!n})))||void 0===o?void 0:o.length)>0&&l(o),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e.signal.aborted?console.log("Request to fetch Submittable forms was aborted"):console.log("Error fetching Submittable forms",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}()(),function(){e.abort()}}),[]),a.length>0?r.a.createElement("ul",{className:"list-unstyled"},a.map((function(e){return r.a.createElement("li",{key:e.category_id,className:"mb-2"},r.a.createElement("a",{href:e.form_url,target:"_blank",rel:"noopener noreferrer"},e.name))}))):r.a.createElement("p",null,"No current opportunities.")},Ie=function(){var e=Object(s.b)().user,t=Object(c.h)(),a=Object(c.g)(),l=Object(n.useState)(null),o=Object(j.a)(l,2),i=o[0],u=o[1],d=Object(n.useState)(!0),p=Object(j.a)(d,2),b=p[0],h=p[1];return Object(n.useEffect)((function(){var t=new AbortController;return function(){var a=Object(Se.a)(Ne.a.mark((function a(){var n,r,l;return Ne.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("/api/artist?email=".concat(encodeURIComponent(e.email)),{signal:t.signal});case 3:return n=a.sent,a.next=6,n.json();case 6:(r=a.sent).records.length>0&&(l=r.records[0],u(Object(R.a)(Object(R.a)({},l.fields),{},{id:l.id}))),h(!1),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),t.signal.aborted?console.log("Request to fetch Submittable forms was aborted"):(console.log("Error fetching Submittable forms",a.t0),h(!1));case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(){return a.apply(this,arguments)}}()(),function(){t.abort()}}),[e]),Object(n.useEffect)((function(){if(!!!t.hash&&i){var e=i.view_url.split("#")[1];a.replace("/dashboard/#".concat(e))}}),[i,t,a]),b?r.a.createElement(m,null):r.a.createElement("div",{className:"artist-view"},r.a.createElement(f.a,{container:!0,spacing:2},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(je,null,r.a.createElement(Pe,{artist:i})))),r.a.createElement(f.a,{container:!0,spacing:2},r.a.createElement(f.a,{item:!0,xs:12,md:6},r.a.createElement(je,null,r.a.createElement(Te,{artist:i}))),r.a.createElement(f.a,{item:!0,xs:12,md:6},r.a.createElement(je,null,r.a.createElement(Oe,{title:"Current opportunities"}),r.a.createElement(Le,null)))))},_e=function(){return r.a.createElement(O.a,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 mt-4"},r.a.createElement("h1",{className:"mb-4"},"Guest Dashboard Demo")),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"mb-4"},r.a.createElement("h2",{className:"mb-3"},"Published Artworks"),r.a.createElement(M,{title:"Published Artworks",src:"https://airtable.com/embed/shrTY5JWaHMkwbm80?backgroundColor=red&viewControls=on"})))))},De=a(928),Re=function(e){return e.show?r.a.createElement(De.a,{severity:"warning",variant:"filled",className:"mb-2"},r.a.createElement("p",{className:"mb-0"},"Your email address is not verified yet. Please check your inbox for the verification email!")):null},Fe=function(e){var t=e.children,a=Object(s.b)().user;return r.a.createElement("div",{id:"app",className:"d-flex flex-column h-100"},r.a.createElement(k,null),r.a.createElement("main",{className:"py-4 bg-light"},r.a.createElement(b.a,{maxWidth:"xl"},r.a.createElement(Re,{show:a&&!a.email_verified}),t)),r.a.createElement(i,null))},Me={"StART Staff":ve,"Advisory Committee":ye,Curator:we,Artist:Ie,Guest:_e},ze=function(){var e=Object(s.b)().user,t=Me[e["https://streetartoronto.ca/role"]]||Ie;return r.a.createElement(Fe,null,r.a.createElement(t,null))},Je=a(405),We=a.n(Je),Ve=function(){return r.a.createElement(L,null,r.a.createElement(We.a,{googleApiKey:"AIzaSyA_ALY9ZJ2LTUTvnHnkQlzMp4gMqyyGIFA",featuresDataSource:"https://raw.githubusercontent.com/code-for-canada/start-map/master/public/geojson/ftrs.json",wardsDataSource:"https://raw.githubusercontent.com/code-for-canada/start-map/master/public/geojson/wards.json"}))},qe=a(192),Ue=a(407),Ge=a(408),Ye=a(414),Be=a(412),Qe=a(122),He=a(148),Ze=a.n(He),Ke=a(411),Xe=a.n(Ke),$e=a(931);Ze.a.setApiKey("AIzaSyA_ALY9ZJ2LTUTvnHnkQlzMp4gMqyyGIFA"),Ze.a.enableDebug();var et=function(e){var t=e.show,a=e.recordId,n=e.address,l=e.onClose;return r.a.createElement($e.a,{show:t,variant:"success",dismissible:!0,onClose:l},r.a.createElement("p",null,"This location (".concat(n,") has been added to the database.")),r.a.createElement("p",null,r.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"".concat(ue).concat(a)},"Edit on Airtable")))},tt=function(e){var t=e.show,a=e.error,n=e.onClose;return r.a.createElement($e.a,{show:t,variant:"error",dismissible:!0,onClose:n},r.a.createElement("p",null,"There was an error saving this location:"),a&&r.a.createElement("code",null,JSON.stringify(a)))},at=Object(Qe.withScriptjs)(Object(Qe.withGoogleMap)((function(e){return r.a.createElement(Qe.GoogleMap,{google:e.google,defaultZoom:e.zoom,center:{lat:e.mapPosition.lat,lng:e.mapPosition.lng}},r.a.createElement(Xe.a,{style:{width:"100%",height:"40px",paddingLeft:"16px",marginTop:"2px"},onPlaceSelected:e.onPlaceSelected,types:["address"],componentRestrictions:{country:"ca"}}),r.a.createElement(Qe.Marker,{google:e.google,name:"Selected location",draggable:!0,onDragEnd:e.onMarkerDragEnd,position:{lat:e.markerPosition.lat,lng:e.markerPosition.lng}}),r.a.createElement(Qe.Marker,null))}))),nt=function(e){Object(Ye.a)(a,e);var t=Object(Be.a)(a);function a(e){var n;return Object(Ue.a)(this,a),(n=t.call(this,e)).getCity=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0]&&"administrative_area_level_2"===e[t].types[0])return e[t].long_name},n.getArea=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0])for(var a=0;a<e[t].types.length;a++)if("sublocality_level_1"===e[t].types[a]||"locality"===e[t].types[a])return e[t].long_name},n.getState=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return e[a].long_name},n.onChange=function(e){n.setState(Object(qe.a)({},e.target.name,e.target.value))},n.onInfoWindowClose=function(e){},n.onMarkerDragEnd=function(e){var t=e.latLng.lat(),a=e.latLng.lng();Ze.a.fromLatLng(t,a).then((function(e){var r=e.results[0].formatted_address,l=e.results[0].address_components,o=n.getCity(l),c=n.getArea(l),s=n.getState(l);n.setState({address:r||"",area:c||"",city:o||"",state:s||"",lat:t,lng:a,markerPosition:{lat:t,lng:a},mapPosition:{lat:t,lng:a}})}),(function(e){console.error(e)}))},n.onPlaceSelected=function(e){console.log("plc",e);var t=e.formatted_address,a=e.address_components,r=n.getCity(a),l=n.getArea(a),o=n.getState(a),c=e.geometry.location.lat(),s=e.geometry.location.lng();n.setState({address:t||"",area:l||"",city:r||"",state:o||"",markerPosition:{lat:c,lng:s},mapPosition:{lat:c,lng:s}})},n.createLocation=function(){var e=Object(Se.a)(Ne.a.mark((function e(t){var a,r,l;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={fields:{address:n.state.address,coordinates:"".concat(n.state.markerPosition.lat,", ").concat(n.state.markerPosition.lng),ward:n.state.ward,intersection:n.state.intersection,property_description:n.state.propertyDescription,comments:n.state.comments}},e.prev=2,e.next=5,fetch("/api/location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 5:return r=e.sent,e.next=8,r.json();case 8:if(l=e.sent,201===r.status){e.next=11;break}return e.abrupt("return",n.setState({showErrorAlert:!0,error:l.error.message}));case 11:n.setState({showSuccessAlert:!0,recordId:l.recordId}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),n.setState({showErrorAlert:!0,error:e.t0.message});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),n.state={showErrorAlert:!1,showSuccessAlert:!1,address:"",city:"",area:"",state:"",intersection:"",ward:"",propertyDescription:"",comments:"",mapPosition:{lat:n.props.center.lat,lng:n.props.center.lng},markerPosition:{lat:n.props.center.lat,lng:n.props.center.lng}},n}return Object(Ge.a)(a,[{key:"componentDidMount",value:function(){var e=this;Ze.a.fromLatLng(this.state.mapPosition.lat,this.state.mapPosition.lng).then((function(t){var a=t.results[0].formatted_address,n=t.results[0].address_components,r=e.getCity(n),l=e.getArea(n),o=e.getState(n);console.log("city",r,l,o),e.setState({address:a||"",area:l||"",city:r||"",state:o||""})}),(function(e){console.error(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:""},r.a.createElement(at,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyA_ALY9ZJ2LTUTvnHnkQlzMp4gMqyyGIFA","&libraries=places"),loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:this.props.height}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),zoom:this.props.zoom,mapPosition:this.state.mapPosition,markerPosition:this.state.markerPosition,onPlaceSelected:this.onPlaceSelected,onMarkerDragEnd:this.onMarkerDragEnd}),r.a.createElement("form",{className:"mt-5 mb-3",onSubmit:this.createLocation},r.a.createElement("div",{className:"form-group pt-3"},r.a.createElement("label",{htmlFor:""},"Latitude"),r.a.createElement("input",{required:!0,type:"text",name:"lat",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.markerPosition.lat})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Longitude"),r.a.createElement("input",{required:!0,type:"text",name:"lng",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.markerPosition.lng})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Address"),r.a.createElement("input",{required:!0,type:"text",name:"address",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.address})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Area"),r.a.createElement("input",{type:"text",name:"area",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.area})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Ward"),r.a.createElement("input",{type:"text",name:"ward",className:"form-control",onChange:this.onChange,value:this.state.ward})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Intersection"),r.a.createElement("input",{type:"text",name:"intersection",className:"form-control",onChange:this.onChange,value:this.state.intersection})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Property description"),r.a.createElement("input",{type:"text",name:"propertyDescription",className:"form-control",onChange:this.onChange,value:this.state.propertyDescription})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Comments"),r.a.createElement("input",{type:"text",name:"comments",className:"form-control",onChange:this.onChange,value:this.state.comments})),r.a.createElement("div",{className:"mt-4"},r.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Create location"}))),r.a.createElement(et,{show:this.state.showSuccessAlert,address:this.state.address,recordId:this.state.recordId,onClose:function(){return e.setState({showSuccessAlert:!1})}}),r.a.createElement(tt,{show:this.state.showErrorAlert,error:this.state.error,onClose:function(){return e.setState({showErrorAlert:!1})}}))}}]),a}(n.Component);nt.defaultProps={center:se};var rt=nt,lt=function(){return r.a.createElement(L,null,r.a.createElement(O.a,null,r.a.createElement("div",{className:"row mb-4"},r.a.createElement("div",{className:"col-12 my-5"},r.a.createElement(rt,{center:se,height:"400px",zoom:14})))))},ot=function(){var e=Object(n.useState)("Artist"),t=Object(j.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!0),o=Object(j.a)(l,2),c=o[0],i=o[1],m=Object(s.b)().user;return Object(n.useEffect)((function(){m&&(r(m["https://streetartoronto.ca/role"]),i(!1))}),[m]),c?{isLoadingRole:c}:{isLoadingRole:c,role:a,isStaff:"StART Staff"===a,isReviewer:"Advisory Committee"===a,isCurator:"Curator"===a,isArtist:"Artist"===a,isGuest:"Guest"===a}},ct=function(){var e=Object(s.b)().user,t=Object(n.useState)(null),a=Object(j.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(!0),u=Object(j.a)(i,2),d=u[0],p=u[1],b=Object(c.i)().action,f=void 0===b?"view":b,h=ot(),E=h.isLoadingRole,g=h.isStaff;return Object(n.useEffect)((function(){var t=new AbortController;return function(){var a=Object(Se.a)(Ne.a.mark((function a(){var n,r,l;return Ne.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("/api/artist?email=".concat(encodeURIComponent(e.email)),{signal:t.signal});case 3:return n=a.sent,a.next=6,n.json();case 6:(r=a.sent).records.length>0&&(l=r.records[0],o(Object(R.a)(Object(R.a)({},l.fields),{},{id:l.id}))),p(!1),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),t.signal.aborted?console.log("Request to fetch Submittable forms was aborted"):(console.log("Error fetching Submittable forms",a.t0),p(!1));case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(){return a.apply(this,arguments)}}()(),function(){t.abort()}}),[e]),d||E?r.a.createElement(m,null):"edit"===f?r.a.createElement(mt,{user:e,artist:l,isStaff:g}):r.a.createElement(it,{artist:l,isStaff:g})},st=function(){return r.a.createElement(L,null,r.a.createElement(b.a,{maxWidth:"xl"},r.a.createElement(f.a,{container:!0,justify:"center"},r.a.createElement(f.a,{item:!0,md:6},r.a.createElement("div",{className:"mt-10"},r.a.createElement("h2",{className:"mb-4"},"Your profile has been created!"),r.a.createElement("p",{className:"mb-4"},"Please make sure to keep your profile up to date. This is how we contact you about your current projects, ongoing applications, or future opportunities we think you would be interested in."),r.a.createElement(u.b,{to:"/dashboard",className:"btn btn-primary"},"Back to my dashboard"))))))},it=function(e){var t=e.artist,a=e.isStaff,l=Object(n.useState)(!1),o=Object(j.a)(l,2),s=o[0],i=o[1],m=Object(c.h)(),d=Object(c.g)();return Object(n.useEffect)((function(){var e=m.hash;if(!e||!a){if(!t)return d.push("/profile/edit");var n=t.view_url.split("#")[1];return e.includes(n)?void 0:d.replace("".concat(m.pathname,"#").concat(n))}}),[t,m,d,a]),Object(n.useEffect)((function(){var e=m.hash;if(t&&e){var a=t.view_url.includes(e);i(a)}}),[t,m]),a||s?r.a.createElement(L,null,r.a.createElement(b.a,{maxWidth:"md"},r.a.createElement("div",{className:"my-5"},r.a.createElement("h1",null,s?"Your StART Profile":"StART Artist Profile"),r.a.createElement(Ce,{formId:me}),s&&r.a.createElement(u.b,{className:"btn btn-primary mt-2",to:"/profile/edit"},"Edit your profile")))):r.a.createElement(ut,null)},mt=function(e){var t=e.user,a=e.artist,l=e.isStaff,o=Object(n.useState)(!1),s=Object(j.a)(o,2),i=s[0],m=s[1],u=Object(c.h)(),d=Object(c.g)();if(Object(n.useEffect)((function(){var e=u.hash;if((!e||!l)&&a){var t=a.edit_url.split("#")[1];if(!e.includes(t))return d.replace("".concat(u.pathname,"#").concat(t))}}),[a,u,d,l]),Object(n.useEffect)((function(){var e=u.hash;if(a||e||m(!0),a&&e){var t=a.edit_url.includes(e);m(t)}}),[a,u]),i){var p={entry:{PersonalInformation:{EmailAddress:t.email}}};return r.a.createElement(L,null,r.a.createElement(b.a,{maxWidth:"md"},r.a.createElement("div",{className:"my-5"},r.a.createElement("h1",null,"".concat(a?"Edit ":"Create "," Your StART Profile")),r.a.createElement(Ce,{formId:me,opts:p,afterSubmit:function(e,t){e.preventDefault(),d.push("/profile/success")}}))))}return r.a.createElement(ut,null)},ut=function(){return r.a.createElement(L,null,r.a.createElement(b.a,{maxWidth:"xl"},r.a.createElement("p",{className:"mt-4 mb-1"},"You are not authorized to see this page.")))},dt=(a(894),function(){var e=Object(s.b)(),t=e.isLoading,a=e.isAuthenticated;return t?r.a.createElement(m,null):r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/"},a?r.a.createElement(c.a,{to:"/dashboard"}):r.a.createElement(T,null)),r.a.createElement(S,{path:"/dashboard",component:ze}),r.a.createElement(S,{path:"/update",component:I}),r.a.createElement(S,{path:"/map",component:Ve}),r.a.createElement(S,{path:"/location",component:lt}),r.a.createElement(S,{path:"/profile",exact:!0,component:ct}),r.a.createElement(S,{path:"/profile/success",exact:!0,component:st}),r.a.createElement(S,{path:"/profile/:action",component:ct}))}),pt=function(e){var t=e.children,a=Object(c.g)();return r.a.createElement(s.a,{domain:"start-dashboard.us.auth0.com",clientId:"cWqYhyMs67OwN4fOWou5N6vAyJg3zsy3",redirectUri:window.location.origin,onRedirectCallback:function(e){a.push((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname)}},t)};o.a.render(r.a.createElement(u.a,null,r.a.createElement(pt,null,r.a.createElement(dt,null))),document.getElementById("root"))}},[[418,1,2]]]);
//# sourceMappingURL=main.318f2f4a.chunk.js.map